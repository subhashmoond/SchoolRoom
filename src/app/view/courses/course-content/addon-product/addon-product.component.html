<p-toast />
<div class="card">

    <div class="grid client-dashborad-header mb-4 align-items-center">
        <div class="col-6">
            <h4 class="subheading-color">Add-On Products</h4>
        </div>

        <div class="col-6 flex justify-content-end">
            <button type="submit" (click)="addProduct()" pButton pRipple label="+ Add Product"
            class="secondary-button px-6 text-sm"></button>
        </div>

    </div>



    <div class="curiculam-h" >

        <p-table [rows]="10" [showLoader]="true" [responsive]="true" [scrollable]="true" scrollHeight="37.938rem"
            selectionMode="single" class="client-data-table" [value]="addedProductList">
    
            <ng-template pTemplate="header" class="p-4">
                <tr class="w-full flex flex-wrap">
                    <th style="width:20%;word-break:break-all;" class="pl-3 pt-3 border-none primary-color">THUMBNAIL</th>
                    <th style="width:20%;word-break:break-all;" class="pl-4 pt-3 border-none primary-color">NAME</th>
                    <th style="width:20%;word-break:break-all;" class="pl-4 pt-3 border-none primary-color">PRODUCT TYPE</th>
                    <th style="width:20%;word-break:break-all;" class="pl-4 pt-3 border-none primary-color">PAID TYPE</th>
                    <th style="width:20%;word-break:break-all;" class="pl-4 pt-3 border-none primary-color">ACTION</th>
                </tr>
    
            </ng-template>


            
                <ng-template pTemplate="body" let-data>
        
                    <tr class="w-full flex flex-wrap">
                        <td style="width: 20%;word-break:break-all;" class="pl-4 capitalize">
                            <img style="width: 40px;" [src]="data.thumbnail">
                        </td>
                        <td style="width: 20%;word-break:break-all;" class="pl-4">
                            {{data.name}}
                        </td>
        
                        <td style="width: 20%;word-break:break-all;" class="pl-4">
                            @if(data.type === "digital-product"){
                                Digital Product
                            }
                            @else {
                                Test
                            }
                        </td>
        
                        <td style="width: 20%;word-break:break-all;" class="pl-4">
                            @if(data.isPaid === true){
                                Paid
                            }
                            @else {
                                Free
                            }
                        </td>


                        <td style="width: 20%;word-break:break-all;" class="pl-4">
                            <i class="pi pi-trash" style="color: red;" (click)="deleteDigitalProduct(data.id)" ></i>
                        </td>
        
                    </tr>
    
    
    
                </ng-template>
            
                
    
            <ng-template pTemplate="emptymessage">
                <div class="flex align-items-center justify-content-center flex-column h-full w-full h-30rem">
                    <img src="../../../../../assets/images/icon/no-data.svg">
                    <p class="text-primary-purple text-xl font-semibold mt-6 mb-1">No Product</p>
                    <p class="text-primary-purple text-base font-normal mt-2">There is no Product to show you right now.</p>
                </div>

            </ng-template>


            @if(isLoader){
                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>

                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>

                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>
                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>
            }
    
        </p-table>
    </div>

</div>

@if(isAddOnProduct){
    <p-sidebar [(visible)]="isAddOnProduct" position="right" [style]="{width:'27.6%'}">
    <h4 class="pt-4 pb-4 m-0 font-semibold line-height-sm">Create Coupons </h4>

        <form [formGroup]="addOnProductForm" class="w-full flex flex-wrap">

            <div class="grid nested-grid mt-3">
    
                <div class="col-12">
                    <div class="grid">

                        <div class="col-12">
                            <label class="w-full mb-1 text-sm font-medium line-height-exsm inline-block"> Select Product Type
                                <span>*</span></label>
                                <p-dropdown class="capitalize" [filter]="true" filterBy="name" id="officeid" class="text-sm w-full"
                            [required]="true" formControlName="productType" [options]="productType"
                            optionValue="type" optionLabel="name" (onChange)="onProductTypeChange($event)"
                            placeholder="Select Student"></p-dropdown>
                        </div>


                        @if( addOnProductForm.get('productType')?.value === "digital_product"){

                            <div class="col-12">
                                <label class="w-full mb-1 text-sm font-medium line-height-exsm inline-block"> Select Product
                                    <span>*</span></label>
                                    <p-dropdown class="capitalize" [filter]="true" filterBy="name" id="officeid" class="text-sm w-full"
                                [required]="true" formControlName="productId" [options]="productList"
                                optionValue="id" optionLabel="title"
                                placeholder="Select Student"></p-dropdown>
                            </div>

                        }


                        @if( addOnProductForm.get('productType')?.value === "test_series"){

                            <div class="col-12">
                                <label class="w-full mb-1 text-sm font-medium line-height-exsm inline-block"> Select Test Series
                                    <span>*</span></label>
                                    <p-dropdown class="capitalize" [filter]="true" filterBy="name" id="officeid" class="text-sm w-full"
                                [required]="true" formControlName="productId" [options]="testListData"
                                optionValue="id" optionLabel="title"
                                placeholder="Select Student"></p-dropdown>
                            </div>

                        }

    
    
                    </div>
                </div>
    
    
    
            </div>
    
            <div
                class="assign-fix-buttons bg-white py-3 px-5 fixed flex flex-wrap aign-items-center justify-content-end mt-5">
                <button pButton pRipple label="Cancel" (click)="close()"
                    class="primary-border-button px-5 mr-3 text-sm"></button>
                <button type="submit" pButton pRipple label="Add" (click)="saveProduct()"
                    class="primary-button px-5 text-sm"></button>
            </div>
        </form>
        
    </p-sidebar>
}