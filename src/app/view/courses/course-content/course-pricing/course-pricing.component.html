<p-toast />

<div class="card">

    <div class="grid client-dashborad-header mb-4 align-items-center">
        <div class="col-12">
            <h5 class="subheading-color">List for sale</h5>

            <!-- <span class="mt-3 text-base text-color">This will list your course for selling. You need to publish the
                course to enable this option</span> -->
        </div>

        <div class="col-12">
            <div class="surface-ground p-4 border-round-sm">

                <div class="card flex justify-center">
                    <form [formGroup]="courseSaleForm">
                        <div class="flex flex-wrap gap-4">

                            <div class="flex items-center">
                                <p-checkbox formControlName="website" [binary]="true"></p-checkbox>
                                <label for="ingredient1" class="ml-2">Website</label>
                            </div>

                            <div class="flex items-center">
                                <p-checkbox formControlName="android" [binary]="true"></p-checkbox>
                                <label for="ingredient2" class="ml-2">Android</label>
                            </div>

                            <div class="flex items-center">
                                <p-checkbox formControlName="ios" [binary]="true"></p-checkbox>
                                <label for="ingredient3" class="ml-2">iOS</label>
                            </div>

                            <!-- <div class="flex items-center">
                                <p-checkbox formControlName="none" [binary]="true"></p-checkbox>
                                <label for="ingredient4" class="ml-2">None</label>
                            </div> -->

                        </div>
                    </form>

                </div>

            </div>
        </div>

    </div>





    <div class="grid client-dashborad-header mb-4 align-items-center">
        <div class="col-6">
            <h5 class="subheading-color">Courses Pricing</h5>
        </div>

        <div class="col-6 flex justify-content-end align-items-end">
            <p-button class="create-button border-round-md" (click)="openCreatePriceSidebar()">+ Add Pricing
                Plan</p-button>
        </div>

    </div>


    <div class="mb-5">
        <p-table [rows]="10" [showLoader]="true" [responsive]="true" [scrollable]="true" scrollHeight="37.938rem"
            selectionMode="single" class="client-data-table test-table " [value]="priceList">

            <ng-template pTemplate="header" class="p-4">
                <tr class="w-full flex flex-wrap">
                    <th style="width:33%;word-break:break-all;" class="pl-3 pt-3 border-none primary-color">Plan Name
                    </th>
                    <th style="width:33%;word-break:break-all;" class="pl-4 pt-3 border-none primary-color">Price</th>
                    <th style="width:33%;word-break:break-all;"
                        class="pl-4 pt-3 border-none primary-color flex justify-content-end">Action
                    </th>
                </tr>

            </ng-template>


            <ng-template pTemplate="body" let-data>
                <tr class="w-full flex flex-wrap">
                    <td style="width: 33%;word-break:break-all;" class="pl-4 capitalize">
                        {{data.name}}
                    </td>
                    <td style="width: 33%;word-break:break-all;" class="pl-4">
                        @if(data.price === null){
                        00.0
                        }@else {
                        {{data.price}}
                        }
                    </td>

                    <td style="width: 33%;" class="pl-4 flex justify-content-end">
                        <i class="pi pi-pen-to-square mr-3" (click)="editPlan(data)"></i>
                        <i class="pi pi-trash red-500 input-required-color" (click)="deletePlan(data)"></i>
                    </td>

                </tr>
            </ng-template>



            <ng-template pTemplate="emptymessage">

                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>
                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>
                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>
                <tr>
                    <td colspan="5"><p-skeleton height="3rem" styleClass="mb-2" /></td>
                </tr>

                <!-- <div class="flex align-items-center justify-content-center flex-column h-full w-full h-30rem">
                    <img src="../../../../../assets/images/icon/no-data.svg">
                    <p class="text-primary-purple text-xl font-semibold mt-6 mb-1">No Pricing</p>
                    <p class="text-primary-purple text-base font-normal mt-2">There is no Pricing to show you right now.</p>
                </div> -->
            </ng-template>

        </p-table>
    </div>


    <div class="grid nested-grid client-dashborad-header mb-4 mt-4 align-items-center">
        <div class="col-12">
            <h5 class="subheading-color">Tax Settings</h5>
            <!-- <span class="mt-3 text-base text-color line-height-2">Use this option to adjust tax values for individual courses. It is
                disabled if 'No Tax' is selected or if automated tax collection through Stripe is enabled.</span> -->
        </div>

        <div class="col-12">
            <div class="surface-ground p-4 border-round-sm">

                <form [formGroup]="taxForm">

                    <div class="grid card flex justify-center">
                        <div class="col-6">
                            <label class="w-full mb-1  font-medium line-height-exsm inline-block">Tax Rate (in %)</label>
                        </div>

                        <div class="col-6">
                            <input class="w-full" pInputText placeholder="e.g 18" formControlName="taxRate" />
                        </div>

                    </div>

                    <div class="grid card flex justify-center mt-2">
                        <div class="col-6">
                            <label class="w-full mb-1  font-medium line-height-exsm inline-block">Show Pricing including taxes
                            </label>
                        </div>

                        <div class="col-6 flex">

                            <div class="mr-1">
                                <p-checkbox formControlName="yes" [binary]="true"></p-checkbox>
                                <label for="ingredient4" class="ml-2">Yes</label>
                            </div>

                        </div>

                    </div>

                </form>

            </div>
        </div>

    </div>

    <div class="mt-4">
        <button type="button" pButton pRipple (click)="saveDetails()" label="Save"
            class="secondary-button px-6 text-sm"></button>
    </div>



</div>


@if(isCreatePlan){
<p-sidebar [(visible)]="isCreatePlan" position="right" [style]="{width:'40%'}">
    <h4 class="pt-4 pb-4 m-0 font-semibold line-height-sm">Add Pricing Plan</h4>

    <form [formGroup]="createPlanForm" (ngSubmit)="submitPlan()" class="w-full flex flex-wrap">

        <div class="grid nested-grid mt-3">

            <div class="col-12">
                <div class="grid">

                    <div class="col-12">
                        <label class="w-full mb-1 text-sm font-medium line-height-exsm inline-block"> Plan Name
                            <span>*</span></label>
                        <input class="w-full capitalize" placeholder="Enter Name" type="text" pInputText
                            formControlName="planname" />
                    </div>

                    <div class="col-6">
                        <label class="w-full mb-1 text-sm font-medium line-height-exsm inline-block"> Price
                            <span>*</span></label>

                            <p-inputGroup>
                                <p-inputGroupAddon>
                                    <!-- <i class="pi pi-calendar-clock"></i> -->
                                    ₹
                                </p-inputGroupAddon>
                                <input class="w-full capitalize" placeholder="e.g 10,000" pKeyFilter="num" type="text"
                            pInputText formControlName="mrp" />
                              </p-inputGroup>
                        
                    </div>

                    <div class="col-6">
                        <label class="w-full mb-1 text-sm font-medium line-height-exsm inline-block"> Discount Price
                        </label>

                        <p-inputGroup>
                            <p-inputGroupAddon>
                                ₹
                            </p-inputGroupAddon>
                            <input class="w-full capitalize" placeholder="e.g 8,000" pKeyFilter="num" type="text" pInputText
                            formControlName="discount" />
                          </p-inputGroup>
                        
                    </div>

                    <div class="col-12 flex justify-content-center align-items-center border-top pt-4 mt-4">
                        <p-inputSwitch formControlName="instalment" [trueValue]="true" (onChange)="instolmentData($event)" />
                        <label class="text-sm font-medium line-height-exsm ml-2"> Add pay in instalment plan
                        </label>
                    </div>

                    @if(createPlanForm.get('instalment')?.value == true){
                    <div class="col-12 plan-design-3 border-bottom pb-4 mb-4">
                        <div class="plan-inner">
                            <p-radioButton value="Monthly" formControlName="instalmentType"
                                name="instalmentType"></p-radioButton>
                                
                            <label class="ml-2">Monthly instalments</label>
                        </div>

                        <!-- Show this input if the monthly instalment is selected -->

                        <div class="plan-inner">
                            @if(createPlanForm.get('instalmentType')?.value === 'Monthly'){

                            <input class="w-full capitalize" type="text" pInputText pKeyFilter="num"
                                formControlName="instalmentMonthsValue" placeholder="No. of months" />
                            }

                        </div>

                        <div class="plan-inner">
                            @if(createPlanForm.get('instalmentType')?.value === 'Monthly'){
                            <input class="w-full capitalize" type="text" pInputText pKeyFilter="num"
                                formControlName="emiamount" placeholder="EMI Amount" />
                            }
                        </div>

                        <div class="plan-inner">
                            <p-radioButton value="weekly" formControlName="instalmentType"
                                name="instalmentType"></p-radioButton>
                            <label class="ml-2">Weekly instalments</label>
                        </div>

                        <!-- Show this input if the weekly instalment is selected -->
                        <div class="plan-inner">
                            @if(createPlanForm.get('instalmentType')?.value === 'weekly'){
                            <input class="w-full capitalize" type="text" pKeyFilter="num" pInputText
                                placeholder="No. of weeks" formControlName="instalmentMonthsValue" />
                            }
                        </div>

                        <div class="plan-inner">
                            @if(createPlanForm.get('instalmentType')?.value === 'weekly'){
                            <input class="w-full capitalize" type="text" pInputText pKeyFilter="num"
                                formControlName="emiamount" placeholder="EMI Amount" />
                            }
                        </div>


                    </div>


                    <!-- <div class="col-12 plan-design border-bottom pb-4 mb-4">
                        <div class="plan-inner">
                            

                            <p-radioButton value="monthly" formControlName="instalmentType" name="group1"   />
                            <label class="ml-2"> Monthly instalments </label>

                        </div>

                        <div class="plan-inner">
                            <input class="w-full capitalize" type="text" pInputText
                                formControlName="instalmentMonthsValue" placeholder="No. of months" />
                        </div>


                        <div class="plan-inner">
                            <p-radioButton value="Weekly" formControlName="instalmentType" name="group2"  />
                            <label class="ml-2"> Weekly instalments </label>
                        </div>

                        <div class="plan-inner">
                           
                            <input class="w-full capitalize" type="text" pInputText placeholder="No. of weeks" formControlName="instalmentWeeklyValue" />
                        </div>

                    </div> -->
                    }





                    <div class="col-12">
                        <div class="flex align-items-center">
                            <p-checkbox formControlName="duration" label="Limit course access duration" name="duration"
                                [binary]="true" />
                        </div>
                    </div>

                    @if(createPlanForm.get('duration')?.value === true){
                    <div class="col-12 plan-design">
                        <div class="plan-inner">
                            <p-radioButton name="durationDate" value="Date" formControlName="durationDate" />
                            <label class="ml-2"> Until fixed date </label>

                        </div>

                        @if(durationType == "Date"){
                        <div class="plan-inner">
                            <p-calendar [showIcon]="true" inputId="icondisplay" formControlName="durationDateValue" />
                        </div>
                        }

                    </div>


                    <div class="col-12 plan-design pb-4 mb-4">

                        <div class="plan-inner">
                            <p-radioButton name="durationDate" value="Days" formControlName="durationDate" />
                            <label class="ml-2"> Until specific number of days</label>
                        </div>

                        @if(durationType == "Days"){
                        <div class="plan-inner">
                            <input class="w-full capitalize" type="text" pInputText placeholder="No. of Days"
                                formControlName="durationDaysValue" />
                        </div>
                        }

                    </div>
                    }

                </div>
            </div>



        </div>

        <div
            class="assign-fix-buttons bg-white py-3 px-5 fixed flex flex-wrap aign-items-center justify-content-end mt-5">
            <button pButton pRipple label="Cancel" class="primary-border-button px-5 mr-3 text-sm"></button>
            <button type="submit" pButton pRipple label="Add Plan" class="primary-button px-5 text-sm"></button>
        </div>
    </form>

</p-sidebar>
}