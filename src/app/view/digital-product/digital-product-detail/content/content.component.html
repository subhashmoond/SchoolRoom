<p-toast></p-toast>
<!-- <p-confirmDialog styleClass="confirmation-pop-up-dialog"></p-confirmDialog> -->


<div class="cards">
    <div class="grid client-dashborad-header mb-4 align-items-center">
        <div class="col-12">
            <h4 class="subheading-color">Content</h4>
            <p>Edit the content offered in your downloadable.</p>
        </div>
    </div>
</div>


@if(digitalProductDetail.productType.name === "Physical goods"){

<div class="flex align-items-center justify-content-center flex-column h-full w-full h-30rem">
    <img src="../../../../../../assets/images/icon/no-data.svg">
    <p class="text-primary-purple text-xl font-semibold mt-6 mb-1">This is Physical goods</p>
</div>

}
@else{



<div class="grid mb-5">

    <div class="col-12 mb-2">
        <div class="w-full">
            <label class="w-full mb-1  font-medium line-height-exsm inline-block">Title<span>*</span></label>
            <input class="w-full capitalize" pInputText [(ngModel)]="fileTitleValue" placeholder="Enter file title"
                required="true" />
        </div>
    </div>


    <div class="col-12">

        @switch (digitalProductDetail.productType) {
        @case ("document") {
        <div
            class="border-solid border-round-lg main-border-color border-2 p-4 flex flex-column flex-wrap align-items-center justify-content-center user-image relative">

            <img width="100" height="100"
                [src]="selectedFileObjectUrl ? selectedFileObjectUrl : '../../../../assets/images/icon/Image.svg'"
                alt="Image Preview" [ngClass]="selectedFileObjectUrl ? 'w-full h-full' : 'w-4rem h-4rem'" />
            @if(selectedFileObjectUrl){
            <i class="pi pi-times profile-remove-icon" (click)="profileImageRemove()" style="font-size: 1rem"></i>
            }

            @if(!selectedFileObjectUrl){
            <h6 class="text-center mt-3">Upload downloadable content</h6>
            <span class="text-xs text-color-secondary text-center mt-2"> You can upload a maximum of five files up to
                250 MB Accepted file types: .pdf, .docx, .csv, .xlsx, .ppt </span>
            }

            <span class="flex flex-wrap align-items-center justify-content-center mt-4 mb-1">
                @if(!selectedFileObjectUrl){
                <img class="h-1rem w-1rem" src="../../../../assets/images/icon/upload-icon.svg">
                }
                <p-fileUpload #fileUpload [showUploadButton]="true" mode="basic"
                    class="bg-none text-base text-700 border-0 z-2 required-upload profile-message-remove"
                    chooseLabel="Upload" name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php"
                    accept=".pdf, .docx, .csv, .xlsx, .ppt" [maxFileSize]="maxFileSizeLimit"
                    (onSelect)="onFileSelect($event)"></p-fileUpload>
            </span>



        </div>
        }

        @case ("image") {
        <div
            class="border-solid border-round-lg main-border-color border-2 p-4 flex flex-column flex-wrap align-items-center justify-content-center user-image relative">

            <img width="100" height="100"
                [src]="selectedFileObjectUrl ? selectedFileObjectUrl : '../../../../assets/images/icon/Image.svg'"
                alt="Image Preview" [ngClass]="selectedFileObjectUrl ? 'w-full h-full' : 'w-4rem h-4rem'" />
            @if(selectedFileObjectUrl){
            <i class="pi pi-times profile-remove-icon" (click)="profileImageRemove()" style="font-size: 1rem"></i>
            }

            @if(!selectedFileObjectUrl){
            <h6 class="text-center mt-3">Upload downloadable content</h6>
            <span class="text-xs text-color-secondary text-center mt-2"> You can upload a maximum of five files up to
                250 MB Accepted file types: .png, .jpg, .gif, .webp </span>
            }

            <span class="flex flex-wrap align-items-center justify-content-center mt-4 mb-1">
                @if(!selectedFileObjectUrl){
                <img class="h-1rem w-1rem" src="../../../../assets/images/icon/upload-icon.svg">
                }
                <p-fileUpload #fileUpload [showUploadButton]="true" mode="basic"
                    class="bg-none text-base text-700 border-0 z-2 required-upload profile-message-remove"
                    chooseLabel="Upload" name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php"
                    accept=".png, .jpg, .gif, .webp" [maxFileSize]="maxFileSizeLimit"
                    (onSelect)="onFileSelect($event)"></p-fileUpload>
            </span>



        </div>
        }

        @case ("link") {

        <div class="w-full">
            <label class="w-full mb-1  font-medium line-height-exsm inline-block">Link<span>*</span></label>
            <input class="w-full" pInputText [(ngModel)]="contentURLValue"
                placeholder="e.g https://yourdomain.org/filelink" required="true" />
        </div>

        }

        @case ("video") {
        <div
            class="border-solid border-round-lg main-border-color border-2 p-4 flex flex-column flex-wrap align-items-center justify-content-center user-image relative">

            <img width="100" height="100"
                [src]="selectedFileObjectUrl ? selectedFileObjectUrl : '../../../../assets/images/icon/Image.svg'"
                alt="Image Preview" [ngClass]="selectedFileObjectUrl ? 'w-full h-full' : 'w-4rem h-4rem'" />
            @if(selectedFileObjectUrl){
            <i class="pi pi-times profile-remove-icon" (click)="profileImageRemove()" style="font-size: 1rem"></i>
            }

            @if(!selectedFileObjectUrl){
            <h6 class="text-center mt-3">Upload downloadable content</h6>
            <span class="text-xs text-color-secondary text-center mt-2"> You can upload a maximum of five files up to
                250 MB Accepted file types: .mp4 </span>
            }

            <span class="flex flex-wrap align-items-center justify-content-center mt-4 mb-1">
                @if(!selectedFileObjectUrl){
                <img class="h-1rem w-1rem" src="../../../../assets/images/icon/upload-icon.svg">
                }
                <p-fileUpload #fileUpload [showUploadButton]="true" mode="basic"
                    class="bg-none text-base text-700 border-0 z-2 required-upload profile-message-remove"
                    chooseLabel="Upload" name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php"
                    accept="video/mp4" [maxFileSize]="maxFileSizeLimit"
                    (onSelect)="onFileSelect($event)"></p-fileUpload>
            </span>



        </div>
        }

        @case ("text") {


        <div class="w-full">
            <label class="w-full mb-1  font-medium line-height-exsm inline-block"> Description </label>
            <p-editor [(ngModel)]="contentStringValue" [style]="{ height: '200px' }"></p-editor>
        </div>

        }

        @case ("physical_goods") {

        <div class="col-12 mb-5">
            <div class="w-full">
                <label class="w-full mb-1  font-medium line-height-exsm inline-block"> Description </label>
                <p-editor [(ngModel)]="contentStringValue"
                    placeholder="Please mail your physical address at subhashmoondsk@gmail.com from your registered email ID."
                    [style]="{ height: '200px' }"></p-editor>
            </div>
        </div>

        }



        }





        <div class="col-12 flex justify-content-end border-bottom-light bg-white pb-6 pt-4">
            <button (click)="submit()" type="button" pButton pRipple label="Save"
                class="secondary-button px-6"></button>
        </div>


    </div>




</div>

<!-- Document List  -->


@if(!isLoader){
@if(contentListData.length > 0){
<h3 class="m-0 mb-2 flex flex-wrap align-items-center">Contents<span
        class="flex align-items-center justify-content-center w-2rem h-2rem 
               form-header-bg border-round-sm font-semibold text-sm text-primary-purple ml-2">{{contentListData.length}}</span>
</h3>
@for(data of contentListData; track $index){
<div
    class="grid grid-nogutter mt-3 py-3 px-4 secondary-shadow border-1 light-secondary-border border-round-xl align-items-center">

    <div class="col-1">

        @switch (digitalProductDetail.productType) {
        @case ("document") {
        <img class="h-3rem w-3rem" src="../../../../../../assets/images/icon/Pdf.svg" alt="">
        }

        @case ("image") {
        <img class="h-3rem w-3rem" src="../../../../../../assets/images/icon/Image.svg" alt="">
        }

        @case ("link") {
        <img class="h-3rem w-3rem" src="../../../../../assets/images/icon/link-content.png" alt="">
        }

        @case ("video") {
        <img class="h-3rem w-3rem" src="../../../../../../assets/images/icon/video.svg" alt="">
        }

        @case ("text") {
        <img class="h-3rem w-3rem" src="../../../../../../assets/images/icon/Word.svg" alt="">

        }

        }



    </div>

    <div class="col-6 pl-3 flex flex-wrap align-items-center">
        <!-- <span
                class="right-icon light-green-bg dark-green-shadow border-circle flex flex-wrap align-items-center justify-content-center">
                <img src="../../../../../../assets/images/icon/right-icon.svg" alt="Right">
            </span> -->
        <h4 class="secondary-text-color font-medium ellipsis-two-lines capitalize" [pTooltip]="data.name"
            tooltipPosition="top">{{data.name ? data.name :
            'Not Available'}}</h4>

    </div>

    <div class="col-5">
        <div class="w-auto ml-auto mr-0 flex flex-wrap justify-content-end ">
            <!-- <span
                    class="aadhar-buttons cursor-pointer form-header-bg flex flex-wrap align-items-center justify-content-center border-round-sm">
                    <img class="w-2rem h-2rem" src="../../../../../../assets/images/icon/download-icon.svg">
                </span> -->
            <span
                class="aadhar-buttons cursor-pointer ml-2 form-header-bg flex flex-wrap align-items-center justify-content-center border-round-sm">
                <img class="w-2rem h-2rem" (click)="videoContent(data)"
                    src="../../../../../../assets/images/icon/eye-unfill-icon.svg">
            </span>
            <span
                class="aadhar-buttons cursor-pointer ml-2 light-danger-bg flex flex-wrap align-items-center justify-content-center border-round-sm">
                <img class="w-2rem h-2rem" (click)="deleteDigitalProduct(data.id)"
                    src="../../../../../../assets/images/icon/delete-unfill-icon.svg">
            </span>
        </div>
    </div>

</div>
}
}
@else {
<div class="flex align-items-center justify-content-center flex-column h-full w-full h-30rem">
    <img src="../../../../../../assets/images/icon/no-data.svg">
    <p class="text-primary-purple text-xl font-semibold mt-6 mb-1">No Contents</p>
    <p class="text-primary-purple text-base font-normal mt-2">There is no contents to show you right now.</p>
</div>
}
}
@else {
<p-skeleton styleClass="h-7rem mt-2 border-round-xl primary-bg-lightgray"></p-skeleton>
<p-skeleton styleClass="h-7rem mt-3 border-round-xl primary-bg-lightgray"></p-skeleton>
<p-skeleton styleClass="h-7rem mt-3 border-round-xl primary-bg-lightgray"></p-skeleton>
<p-skeleton styleClass="h-7rem mt-3 border-round-xl primary-bg-lightgray"></p-skeleton>
<p-skeleton styleClass="h-7rem mt-3 border-round-xl primary-bg-lightgray"></p-skeleton>
}



}



<!-- Digital Product Content Preview  -->
@if (isContentPreview) {
<p-sidebar class="p-0 pt-1 pb-1" [(visible)]="isContentPreview" [fullScreen]="true">

    <div class="p-8">
     

                <div (click)="back()" class="text-xl font-semibold mb-4 cursor-pointer">
                    <i class="pi pi-arrow-left"></i> Back
                </div>

        @switch (digitalProductDetail.productType) {
        @case ("text") {
        <p class="m-0">
            <!-- {{data.text}} -->
            <p-editor [(ngModel)]="contentViewData.text" [readonly]="true" [style]="{ height: 'auto' }"
                [class.hide-toolbar]="hideHeader"></p-editor>
        </p>
        }
        @case ("video") {
        <video width="100%" height="540px" controls>
            <source [src]="getSafeUrl(contentViewData.url)" type="video/mp4" />
            Your browser does not support the video tag.
        </video>
        }
        @case ("document") {
        <iframe [src]="getSafeUrl('https://docs.google.com/gview?embedded=true&url=' + contentViewData.url)"
            width="100%" height="600" frameborder="0">
            Your browser does not support PDFs.
        </iframe>
        }

        @case ("image") {
        <img [src]="contentViewData.url" style=" width: 100%; ">
        }

        @case ("link") {
        <a [href]="contentViewData.link_content" target="_blank" rel="noopener noreferrer">view link</a>
        }

        }
    </div>


</p-sidebar>
}